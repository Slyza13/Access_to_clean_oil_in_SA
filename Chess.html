<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple Chess</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      padding-top: 40px;
      font-family: sans-serif;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(8, 60px);
      grid-template-rows: repeat(8, 60px);
      border: 2px solid #000;
    }
    .cell {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      cursor: pointer;
    }
    .white { background-color: #f0d9b5; }
    .black { background-color: #b58863; }
    .selected { outline: 3px solid red; }
  </style>
</head>
<body>
  <div class="board" id="board"></div>

  <script>
    const board = document.getElementById('board');
    let selectedCell = null;
    let turn = 'white';

    const pieces = {
      'R': '♖', 'N': '♘', 'B': '♗', 'Q': '♕', 'K': '♔', 'P': '♙',
      'r': '♜', 'n': '♞', 'b': '♝', 'q': '♛', 'k': '♚', 'p': '♟'
    };

    const initialBoard = [
      ['r','n','b','q','k','b','n','r'],
      ['p','p','p','p','p','p','p','p'],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['P','P','P','P','P','P','P','P'],
      ['R','N','B','Q','K','B','N','R']
    ];

    const cells = [];

    function createBoard() {
      for (let row = 0; row < 8; row++) {
        cells[row] = [];
        for (let col = 0; col < 8; col++) {
          const cell = document.createElement('div');
          cell.className = 'cell ' + ((row + col) % 2 === 0 ? 'white' : 'black');
          cell.dataset.row = row;
          cell.dataset.col = col;
          cell.textContent = pieces[initialBoard[row][col]] || '';
          board.appendChild(cell);
          cells[row][col] = cell;

          cell.addEventListener('click', () => handleClick(row, col));
        }
      }
    }

    function getPiece(row, col) {
      return initialBoard[row][col];
    }

    function setPiece(row, col, piece) {
      initialBoard[row][col] = piece;
      cells[row][col].textContent = pieces[piece] || '';
    }

    function handleClick(row, col) {
      const piece = getPiece(row, col);
      const isWhitePiece = piece === piece.toUpperCase() && piece !== '';
      const isBlackPiece = piece === piece.toLowerCase() && piece !== '';

      if (selectedCell) {
        const [fromRow, fromCol] = selectedCell;
        const fromPiece = getPiece(fromRow, fromCol);

        if ((isWhitePiece && turn === 'white') || (isBlackPiece && turn === 'black')) {
          selectedCell = [row, col];
          updateSelection();
        } else {
          if (isValidMove(fromRow, fromCol, row, col)) {
            setPiece(row, col, fromPiece);
            setPiece(fromRow, fromCol, '');
            turn = (turn === 'white') ? 'black' : 'white';
          }
          selectedCell = null;
          updateSelection();
        }
      } else if ((turn === 'white' && isWhitePiece) || (turn === 'black' && isBlackPiece)) {
        selectedCell = [row, col];
        updateSelection();
      }
    }

    function updateSelection() {
      document.querySelectorAll('.cell').forEach(cell => cell.classList.remove('selected'));
      if (selectedCell) {
        const [row, col] = selectedCell;
        cells[row][col].classList.add('selected');
      }
    }

    function isValidMove(fromRow, fromCol, toRow, toCol) {
      const piece = getPiece(fromRow, fromCol).toLowerCase();
      const dr = toRow - fromRow;
      const dc = toCol - fromCol;

      if (getPiece(toRow, toCol).toLowerCase() === piece) return false;

      switch (piece) {
        case 'p':
          const dir = getPiece(fromRow, fromCol) === 'P' ? -1 : 1;
          if (dc === 0 && getPiece(toRow, toCol) === '') {
            if (dr === dir || (dr === 2 * dir && fromRow === (dir === -1 ? 6 : 1))) return true;
          } else if (Math.abs(dc) === 1 && dr === dir && getPiece(toRow, toCol) !== '') {
            return true;
          }
          break;
        case 'r': return dr === 0 || dc === 0;
        case 'n': return (Math.abs(dr) === 2 && Math.abs(dc) === 1) || (Math.abs(dr) === 1 && Math.abs(dc) === 2);
        case 'b': return Math.abs(dr) === Math.abs(dc);
        case 'q': return dr === 0 || dc === 0 || Math.abs(dr) === Math.abs
